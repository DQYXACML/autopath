{
  "project_id": "lodestar-firewall-v1",
  "name": "Lodestar Protocol",
  "chain_id": 42161,
  "contracts": [
    "0x92489147621bfDE3f6aDbaB16c24AC080Dc6c522",
    "0xF19693ae3B35037B22ad2184e3a00B71b96F2c61",
    "0xC55EcAB35944C5A9e09fc77B350c7663e560BdA7"
  ],
  "invariants": [
    {
      "id": "plv-glp-ratio-check",
      "name": "sGLP/plvGLP Ratio Monitor",
      "type": "ratio",
      "description": "监控 sGLP 与 plvGLP 的比率，防止价格操纵攻击",
      "parameters": {
        "max_ratio": 1.5,
        "depositor_address": "0x5897f5BAbac89B4EF4b21FD3a7C96d3cC439Edf1",
        "sglp_address": "0x5402B5F40310bDED796c7D0F3FF6683f5C0cFfdf",
        "plvglp_address": "0x5326E71Ff593Ecc2CF7AcaE5Fe57582D6e74CFF1",
        "alert_threshold": 1.3
      },
      "contracts": [
        "0xC55EcAB35944C5A9e09fc77B350c7663e560BdA7"
      ]
    },
    {
      "id": "oracle-price-delta",
      "name": "Oracle Price Sudden Change Detection",
      "type": "delta",
      "description": "检测预言机价格的突然变化",
      "parameters": {
        "max_change_percentage": 0.2,
        "oracle_address": "0xfcd17469343c4e315b046f182eb6f23e1558b93b",
        "monitoring_markets": [
          "0xC55EcAB35944C5A9e09fc77B350c7663e560BdA7",
          "0xF19693ae3B35037B22ad2184e3a00B71b96F2c61"
        ],
        "time_window": 300
      }
    },
    {
      "id": "utilization-rate-check",
      "name": "Market Utilization Rate Monitor",
      "type": "threshold",
      "description": "监控市场利用率，防止异常借贷行为",
      "parameters": {
        "max_utilization": 0.95,
        "warning_utilization": 0.85,
        "critical_markets": [
          "0xF19693ae3B35037B22ad2184e3a00B71b96F2c61",
          "0xC55EcAB35944C5A9e09fc77B350c7663e560BdA7"
        ],
        "comptroller_address": "0x92489147621bfDE3f6aDbaB16c24AC080Dc6c522"
      }
    },
    {
      "id": "borrow-concentration",
      "name": "Borrow Concentration Risk Monitor",
      "type": "custom",
      "description": "监控单一账户的借款集中度风险",
      "parameters": {
        "max_single_borrower_percentage": 0.3,
        "top_n_borrowers": 5,
        "max_top_n_percentage": 0.6,
        "markets": [
          "0xF19693ae3B35037B22ad2184e3a00B71b96F2c61",
          "0xC55EcAB35944C5A9e09fc77B350c7663e560BdA7",
          "0x0C8e019cf1F898aC9F58f6059E970079f4217D68",
          "0xaED3c1B66Fe1a88C1CA98218eB1A9fdEDBc97b1b",
          "0x7396D9095c93Fa7968e8d1bdFa12109F09793Ef2",
          "0xD387e8637439baEB0196F7c9d7cD6d4FF0c6Ad77",
          "0xc37dAAc759bD8dD984cB11e31D6d0CCd5cC4a96f",
          "0xFFEab968bF27B5E8Ad3473E60644d90FdDF69320"
        ]
      }
    },
    {
      "id": "recursive-borrow-detection",
      "name": "Recursive Borrow Attack Detection",
      "type": "custom",
      "description": "检测递归借贷攻击模式",
      "parameters": {
        "max_recursive_depth": 5,
        "max_leverage_ratio": 10,
        "plvglp_market": "0xC55EcAB35944C5A9e09fc77B350c7663e560BdA7",
        "time_window_seconds": 60
      }
    }
  ],
  "fuzzing_config": {
    "enabled": true,
    "threshold": 0.8,
    "max_variations": 120,
    "workers": 8,
    "timeout_seconds": 20,
    "output_path": "./fuzzing_results",
    "auto_trigger": false,
    "trigger_contract_types": [
      "lending",
      "vault",
      "oracle"
    ],
    "min_similarity": 0.75,
    "save_high_similarity": true,
    "print_realtime": true,
    "invariant_check": {
      "enabled": true,
      "project_id": "lodestar-firewall-v1",
      "config_path": "pkg/invariants/configs/lodestar.json"
    }
  },
  "alert_config": {
    "enabled": true,
    "webhook_url": "https://your-webhook-endpoint.com/alerts",
    "email_recipients": [
      "security@lodestar.finance"
    ],
    "severity": "critical",
    "alert_throttle_seconds": 300,
    "notification_channels": [
      "webhook",
      "email",
      "telegram"
    ]
  },
  "monitoring_config": {
    "block_lag": 2,
    "batch_size": 10,
    "check_interval_seconds": 12,
    "state_snapshot_frequency": 100
  }
}
